import{a1 as ie,a2 as re,t as I,a3 as A,n as C,f as K,g as ue,w as S,r as T,W as V,d as _,c as D,h as u,V as F,a4 as G,L as P,a5 as de,a6 as R,s as Y,z as Z,T as z,k as W,b as fe,o as q,e as ve,F as me,M as b,i as ye,I as J,a7 as he,O as Ce,a8 as ke,R as Oe,a9 as ge,a as we,aa as Ie,ab as be}from"./index-C-M2K5MI.js";import{u as Se,a as Q,P as Pe}from"./use-touch-ZXYzMy0u.js";import{o as xe,j as pe,p as X,b as ee,H as Te}from"./constant-DlQg_202.js";import{L as ze}from"./index-C346L4qj.js";function Be(e,{args:t=[],done:o,canceled:a,error:n}){if(e){const s=e.apply(null,t);ie(s)?s.then(i=>{i?o():a&&a()}).catch(n||re):s?o():a&&a()}else o()}let Le=2e3;const Ae=()=>++Le,Ee={show:Boolean,zIndex:C,overlay:I,duration:C,teleport:[String,Object],lockScroll:I,lazyRender:I,beforeClose:Function,overlayProps:Object,overlayStyle:Object,overlayClass:A,transitionAppear:Boolean,closeOnClickOverlay:I};let x=0;const j="van-overflow-hidden";function _e(e,t){const o=Se(),a="01",n="10",s=v=>{o.move(v);const r=o.deltaY.value>0?n:a,d=pe(v.target,e.value),{scrollHeight:y,offsetHeight:O,scrollTop:g}=d;let m="11";g===0?m=O>=y?"00":"01":g+O>=y&&(m="10"),m!=="11"&&o.isVertical()&&!(parseInt(m,2)&parseInt(r,2))&&X(v,!0)},i=()=>{document.addEventListener("touchstart",o.start),document.addEventListener("touchmove",s,{passive:!1}),x||document.body.classList.add(j),x++},l=()=>{x&&(document.removeEventListener("touchstart",o.start),document.removeEventListener("touchmove",s),x--,x||document.body.classList.remove(j))},f=()=>t()&&i(),k=()=>t()&&l();xe(f),K(k),ue(k),S(t,v=>{v?i():l()})}function te(e){const t=T(!1);return S(e,o=>{o&&(t.value=o)},{immediate:!0}),o=>()=>t.value?o():null}const $=()=>{var e;const{scopeId:t}=((e=V())==null?void 0:e.vnode)||{};return t?{[t]:""}:null},[De,Re]=D("overlay"),Ne={show:Boolean,zIndex:C,duration:C,className:A,lockScroll:I,lazyRender:I,customStyle:Object,teleport:[String,Object]};var Me=_({name:De,inheritAttrs:!1,props:Ne,setup(e,{attrs:t,slots:o}){const a=T(),n=te(()=>e.show||!e.lazyRender),s=l=>{e.lockScroll&&X(l,!0)},i=n(()=>{var l;const f=P(de(e.zIndex),e.customStyle);return R(e.duration)&&(f.animationDuration=`${e.duration}s`),Y(u("div",z({ref:a,style:f,class:[Re(),e.className]},t),[(l=o.default)==null?void 0:l.call(o)]),[[Z,e.show]])});return ee("touchmove",s,{target:a}),()=>{const l=u(F,{name:"van-fade",appear:!0},{default:i});return e.teleport?u(G,{to:e.teleport},{default:()=>[l]}):l}}});const je=W(Me),$e=P({},Ee,{round:Boolean,position:b("center"),closeIcon:b("cross"),closeable:Boolean,transition:String,iconPrefix:String,closeOnPopstate:Boolean,closeIconPosition:b("top-right"),destroyOnClose:Boolean,safeAreaInsetTop:Boolean,safeAreaInsetBottom:Boolean}),[Ue,U]=D("popup");var He=_({name:Ue,inheritAttrs:!1,props:$e,emits:["open","close","opened","closed","keydown","update:show","clickOverlay","clickCloseIcon"],setup(e,{emit:t,attrs:o,slots:a}){let n,s;const i=T(),l=T(),f=te(()=>e.show||!e.lazyRender),k=fe(()=>{const c={zIndex:i.value};if(R(e.duration)){const h=e.position==="center"?"animationDuration":"transitionDuration";c[h]=`${e.duration}s`}return c}),v=()=>{n||(n=!0,i.value=e.zIndex!==void 0?+e.zIndex:Ae(),t("open"))},r=()=>{n&&Be(e.beforeClose,{done(){n=!1,t("close"),t("update:show",!1)}})},d=c=>{t("clickOverlay",c),e.closeOnClickOverlay&&r()},y=()=>{if(e.overlay){const c=P({show:e.show,class:e.overlayClass,zIndex:i.value,duration:e.duration,customStyle:e.overlayStyle,role:e.closeOnClickOverlay?"button":void 0,tabindex:e.closeOnClickOverlay?0:void 0},e.overlayProps);return u(je,z(c,$(),{onClick:d}),{default:a["overlay-content"]})}},O=c=>{t("clickCloseIcon",c),r()},g=()=>{if(e.closeable)return u(J,{role:"button",tabindex:0,name:e.closeIcon,class:[U("close-icon",e.closeIconPosition),Te],classPrefix:e.iconPrefix,onClick:O},null)};let m;const oe=()=>{m&&clearTimeout(m),m=setTimeout(()=>{t("opened")})},ne=()=>t("closed"),ae=c=>t("keydown",c),se=f(()=>{var c;const{destroyOnClose:h,round:E,position:B,safeAreaInsetTop:le,safeAreaInsetBottom:ce,show:M}=e;if(!(!M&&h))return Y(u("div",z({ref:l,style:k.value,role:"dialog",tabindex:0,class:[U({round:E,[B]:B}),{"van-safe-area-top":le,"van-safe-area-bottom":ce}],onKeydown:ae},o,$()),[(c=a.default)==null?void 0:c.call(a),g()]),[[Z,M]])}),N=()=>{const{position:c,transition:h,transitionAppear:E}=e,B=c==="center"?"van-fade":`van-popup-slide-${c}`;return u(F,{name:h||B,appear:E,onAfterEnter:oe,onAfterLeave:ne},{default:se})};return S(()=>e.show,c=>{c&&!n&&(v(),o.tabindex===0&&ye(()=>{var h;(h=l.value)==null||h.focus()})),!c&&n&&(n=!1,t("close"))}),Q({popupRef:l}),_e(l,()=>e.show&&e.lockScroll),ee("popstate",()=>{e.closeOnPopstate&&(r(),s=!1)}),q(()=>{e.show&&v()}),ve(()=>{s&&(t("update:show",!0),s=!1)}),K(()=>{e.show&&e.teleport&&(r(),s=!0)}),he(Pe,()=>e.show),()=>e.teleport?u(G,{to:e.teleport},{default:()=>[y(),N()]}):u(me,null,[y(),N()])}});const Ke=W(He);let p=0;function Ve(e){e?(p||document.body.classList.add("van-toast--unclickable"),p++):p&&(p--,p||document.body.classList.remove("van-toast--unclickable"))}const[Fe,w]=D("toast"),Ge=["show","overlay","teleport","transition","overlayClass","overlayStyle","closeOnClickOverlay","zIndex"],Ye={icon:String,show:Boolean,type:b("text"),overlay:Boolean,message:C,iconSize:C,duration:Ce(2e3),position:b("middle"),teleport:[String,Object],wordBreak:String,className:A,iconPrefix:String,transition:b("van-fade"),loadingType:String,forbidClick:Boolean,overlayClass:A,overlayStyle:Object,closeOnClick:Boolean,closeOnClickOverlay:Boolean,zIndex:C};var Ze=_({name:Fe,props:Ye,emits:["update:show"],setup(e,{emit:t,slots:o}){let a,n=!1;const s=()=>{const r=e.show&&e.forbidClick;n!==r&&(n=r,Ve(n))},i=r=>t("update:show",r),l=()=>{e.closeOnClick&&i(!1)},f=()=>clearTimeout(a),k=()=>{const{icon:r,type:d,iconSize:y,iconPrefix:O,loadingType:g}=e;if(r||d==="success"||d==="fail")return u(J,{name:r||d,size:y,class:w("icon"),classPrefix:O},null);if(d==="loading")return u(ze,{class:w("loading"),size:y,type:g},null)},v=()=>{const{type:r,message:d}=e;if(o.message)return u("div",{class:w("text")},[o.message()]);if(R(d)&&d!=="")return r==="html"?u("div",{key:0,class:w("text"),innerHTML:String(d)},null):u("div",{class:w("text")},[d])};return S(()=>[e.show,e.forbidClick],s),S(()=>[e.show,e.type,e.message,e.duration],()=>{f(),e.show&&e.duration>0&&(a=setTimeout(()=>{i(!1)},e.duration))}),q(s),ke(s),()=>u(Ke,z({class:[w([e.position,e.wordBreak==="normal"?"break-normal":e.wordBreak,{[e.type]:!e.icon}]),e.className],lockScroll:!1,onClick:l,onClosed:f,"onUpdate:show":i},Oe(e,Ge)),{default:()=>[k(),v()]})}});function We(){const e=we({show:!1}),t=n=>{e.show=n},o=n=>{P(e,n,{transitionAppear:!0}),t(!0)},a=()=>t(!1);return Q({open:o,close:a,toggle:t}),{open:o,close:a,state:e,toggle:t}}function qe(e){const t=ge(e),o=document.createElement("div");return document.body.appendChild(o),{instance:t.mount(o),unmount(){t.unmount(),document.body.removeChild(o)}}}const Je={icon:"",type:"text",message:"",className:"",overlay:!1,onClose:void 0,onOpened:void 0,duration:2e3,teleport:"body",iconSize:void 0,iconPrefix:void 0,position:"middle",transition:"van-fade",forbidClick:!1,loadingType:void 0,overlayClass:"",overlayStyle:void 0,closeOnClick:!1,closeOnClickOverlay:!1};let L=[],Qe=!1,H=P({},Je);const Xe=new Map;function et(e){return be(e)?e:{message:e}}function tt(){const{instance:e}=qe({setup(){const t=T(""),{open:o,state:a,close:n,toggle:s}=We(),i=()=>{},l=()=>u(Ze,z(a,{onClosed:i,"onUpdate:show":s}),null);return S(t,f=>{a.message=f}),V().render=l,{open:o,close:n,message:t}}});return e}function ot(){if(!L.length||Qe){const e=tt();L.push(e)}return L[L.length-1]}function ct(e={}){if(!Ie)return{};const t=ot(),o=et(e);return t.open(P({},H,Xe.get(o.type||H.type),o)),t}export{Ke as P,Ze as a,ct as s};
